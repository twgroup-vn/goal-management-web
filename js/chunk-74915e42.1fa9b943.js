(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-74915e42"],{6966:function(t,e,a){t.exports=a.p+"img/no-images.a9a1e5e3.jpg"},c975:function(t,e,a){"use strict";var n=a("23e7"),r=a("4d64").indexOf,s=a("a640"),i=a("ae40"),o=[].indexOf,c=!!o&&1/[1].indexOf(1,-0)<0,u=s("indexOf"),l=i("indexOf",{ACCESSORS:!0,1:0});n({target:"Array",proto:!0,forced:c||!u||!l},{indexOf:function(t){return c?o.apply(this,arguments)||0:r(this,t,arguments.length>1?arguments[1]:void 0)}})},f05e:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("nav-menu",{attrs:{params:"route: route"}}),a("div",{staticClass:"container-fluid my-3"},[a("Conversation")],1)],1)},r=[],s=a("664c"),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-3 pr-0 page-content"},[a("conversation-list",{attrs:{"list-conversation":t.dataConversation,"list-user":t.userList}})],1),a("div",{staticClass:"col-9 pl-0 page-content"},[a("chat-box",{attrs:{"user-chat":t.conversationDetail}})],1)])])},o=[],c=(a("96cf"),a("1da1")),u=a("5530"),l=a("2f62"),d=a("29db"),v=a("2b0e"),p=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e,a){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={PageIndex:e,PageSize:a},t.abrupt("return",v["default"].prototype.$http.post("/api/conversation/getListConversationOfUser",n));case 2:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),f=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",v["default"].prototype.$http.get("/api/company/getRelatedUser"));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),m=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e,a,n){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r={PageIndex:e,PageSize:a,Title:n},t.abrupt("return",v["default"].prototype.$http.post("/api/conversation/getMessageOfConversation",r));case 2:case"end":return t.stop()}}),t)})));return function(e,a,n){return t.apply(this,arguments)}}(),g=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",v["default"].prototype.$http.post("/api/conversation/sendMessage",e));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),h=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",v["default"].prototype.$http.post("/api/conversation/create",e));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),C=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=new FormData,a.append("file",e),t.abrupt("return",v["default"].prototype.$http.post("/api/company/uploadAvatar",a,{headers:{"Content-Type":"multipart/form-data"}}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),I=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",v["default"].prototype.$http.get("/api/stickerGroup/getAll"));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),w=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",v["default"].prototype.$http.get("/api/conversation/readNewMessage/".concat(e)));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),b={getListConversation:p,getMessageOfConversation:m,createConversation:h,getUserList:f,sendMessage:g,uploadImage:C,getStickerList:I,readNewMessage:w},k=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b.getListConversation(e.state.searchRequest.pageIndex,e.state.searchRequest.pageSize);case 2:a=t.sent,e.commit("SET_LIST_CONVERSATION",a.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),x=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e,a){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return localStorage.setItem("conversationId",a),t.next=3,b.getMessageOfConversation(e.state.conversationRequest.pageIndex,e.state.conversationRequest.pageSize,a);case 3:n=t.sent,e.commit("SET_CONVERSATION_DETAIL",n.data),e.commit("SET_CONVERSATION_FOCUS",a);case 6:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),_=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e,a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.commit("SET_USER_INFO_CONVERSATION",a);case 1:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),O=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e,a){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b.getUserList(a);case 2:n=t.sent,e.commit("SET_USER_LIST",n.data);case 4:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),S=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e,a){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b.sendMessage(a);case 2:return n=t.sent,t.abrupt("return",n.data);case 4:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),R=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e,a){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b.createConversation(a);case 2:return n=t.sent,t.abrupt("return",n.data);case 4:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),$=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e,a){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b.uploadImage(a);case 2:return n=t.sent,t.abrupt("return",n.data);case 4:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),y=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e,a){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b.getStickerList(a);case 2:n=t.sent,e.commit("SET_STICKER_LIST",n.data);case 4:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),D=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e,a){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b.readNewMessage(a);case 2:return n=t.sent,t.abrupt("return",n.data);case 4:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),L={getListConversation:k,getConversationDetail:x,getUserList:O,createConversation:R,sendMessage:S,setUserInfoConversation:_,uploadImage:$,getStickerList:y,readNewMessage:D},N=(a("4de4"),a("7db0"),a("c975"),a("d81d"),a("fb6a"),a("ac1f"),a("5319"),a("2ef0")),j=a.n(N),T=a("c1df"),E=a.n(T),M=function(t){var e={};return t.listConversation&&t.userList&&t.userList.length&&(e=j.a.map(t.listConversation,(function(e){return e.participantOject=e.participant?JSON.parse(e.participant.replace(/'/g,'"')):"",e.participantOject=j.a.filter(e.participantOject,(function(t){return t!==localStorage.getItem("userId")})),e.userInfo=j.a.find(t.userList,(function(t){return e.participantOject.indexOf(t.id)>-1})),e.isRead=!(!e.isRead&&e.latestMessenger!==localStorage.getItem("userId")),e}))),e},A=function(t){var e={},a=E()(new Date).format("DD/MM/YYYY");return t.conversationDetail&&t.userList&&t.userList.length&&(e=j.a.map(t.conversationDetail,(function(e){return e.userInfo=j.a.find(t.userList,(function(t){return t.id===e.userId})),e.ownMessage=e.userId===localStorage.getItem("userId"),e.isToday=e.createdAt.slice(0,10)===a,e})),e=j.a.reverse(e)),e},U=function(t){var e={};return t.userList&&(e=j.a.map(t.userList,(function(t){return t}))),e},q=function(t){var e={};return t.stickerList&&(e=j.a.map(t.stickerList,(function(t){return t}))),e},J={getListConversation:M,getConversationDetail:A,getUserList:U,getStickerList:q},z=function(t,e){t.listConversation=e.data,t.total=e.total},V=function(t,e){t.conversationDetail=e.data},F=function(t,e){t.userInfoConversation=e},P=function(t,e){t.conversationId=e},B=function(t,e){t.userList=e},Y=function(t,e){t.stickerList=e.data},K={SET_LIST_CONVERSATION:z,SET_CONVERSATION_DETAIL:V,SET_CONVERSATION_FOCUS:P,SET_USER_INFO_CONVERSATION:F,SET_USER_LIST:B,SET_STICKER_LIST:Y},G={listConversation:null,conversationDetail:null,userInfoConversation:null,conversationId:null,userList:null,stickerList:null,total:0,searchRequest:{pageIndex:1,pageSize:30},conversationRequest:{pageIndex:1,pageSize:30}},H={namespaced:!0,state:G,actions:L,getters:J,mutations:K},Q=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"group-conversationList"},[a("div",{staticClass:"main-title"},[t._v("Conversation list")]),a("div",{staticClass:"group-search"},[a("font-awesome-icon",{staticClass:"icon-search",attrs:{icon:["fas","search"]}}),a("el-input",{staticClass:"mb-3",attrs:{placeholder:"Search"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("div",{staticClass:"group-tab"},[a("el-tabs",{attrs:{type:"border-card"}},[a("el-tab-pane",[a("span",{attrs:{slot:"label"},slot:"label"},[a("font-awesome-icon",{attrs:{icon:["fas","history"]}})],1),a("div",{staticClass:"group-chatList",on:{scroll:t.handleScroll}},t._l(t.listConversation,(function(e,n){return a("div",{key:n,staticClass:"chat-list",class:t.conversationId==e.id?"active":"",on:{click:function(a){return t.getConversationDetail(e)}}},[a("div",{staticClass:"d-flex align-items-center"},[a("div",[e&&e.userInfo&&e.userInfo.avatar?a("div",{staticClass:"avatar-circle chatList",style:{backgroundImage:"url("+e.userInfo.avatar+")"}}):a("div",{staticClass:"avatar-circle chatList",style:{backgroundImage:"url("+t.NoAvatar+")"}})]),a("div",{staticClass:"ml-3"},[a("div",{staticClass:"name"},[t._v(t._s(e&&e.userInfo&&e.userInfo.fullName?e.userInfo.fullName:""))]),a("div",{staticClass:"lastest-chat",class:{isRead:!e.isRead}},[t._v(t._s(e.latestMessage?e.latestMessage:""))])])]),a("div",{staticClass:"noti-group"},[e.newMessage>0&&!e.isRead?a("div",{staticClass:"noti-number chat"},[t._v(t._s(e.newMessage))]):t._e()])])})),0)]),a("el-tab-pane",[a("span",{attrs:{slot:"label"},slot:"label"},[a("font-awesome-icon",{attrs:{icon:["fas","address-book"]}})],1),a("div",{staticClass:"group-chatList"},t._l(t.listUser,(function(e,n){return a("div",{key:n,staticClass:"chat-list mb-2",on:{click:function(a){return t.createConversationDetail(e.id)}}},[e.id!==t.userId?a("div",[a("div",{staticClass:"d-flex align-items-center"},[a("div",[e&&e.avatar?a("div",{staticClass:"avatar-circle chatList",style:{backgroundImage:"url("+e.avatar+")"}}):a("div",{staticClass:"avatar-circle chatList",style:{backgroundImage:"url("+t.NoAvatar+")"}})]),a("div",{staticClass:"ml-3"},[a("div",{staticClass:"name"},[t._v(t._s(e&&e.fullName?e.fullName:""))])])])]):t._e()])})),0)])],1)],1)])])},W=[],X=a("6966"),Z=a.n(X),tt={components:{},data:function(){return{search:"",NoAvatar:Z.a,userId:localStorage.getItem("userId"),formData:{participant:[],isDelete:!1,IsRead:!0}}},computed:Object(u["a"])({},Object(l["c"])({searchRequest:function(t){return t.$_conversation.searchRequest},conversationId:function(t){return t.$_conversation.conversationId}})),methods:{handleScroll:function(t){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(0!=t.target.scrollTop){a.next=5;break}return n=e,n.searchRequest.pageSize=n.searchRequest.pageSize+5,a.next=5,n.$store.dispatch("$_conversation/getListConversation");case 5:case"end":return a.stop()}}),a)})))()},getConversationDetail:function(t){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e,localStorage.setItem("userInfoOfConversation",JSON.stringify(t.userInfo)),a.next=4,n.$store.dispatch("$_conversation/setUserInfoConversation",t.userInfo);case 4:return a.next=6,n.$store.dispatch("$_conversation/getConversationDetail",t.id);case 6:case"end":return a.stop()}}),a)})))()},createConversationDetail:function(t){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function a(){var n,r,s,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=e,r=j.a.find(n.listConversation,(function(e){return e.participantOject.indexOf(t)>-1})),!r){a.next=11;break}return localStorage.setItem("userInfoOfConversation",JSON.stringify(r.userInfo)),localStorage.setItem("conversationId",r.id),a.next=7,n.$store.dispatch("$_conversation/setUserInfoConversation",r.userInfo);case 7:return a.next=9,n.$store.dispatch("$_conversation/getConversationDetail",r.id);case 9:a.next=28;break;case 11:return n.formData.participant.push(localStorage.getItem("userId")),n.formData.participant.push(t),n.formData.participant=JSON.stringify(n.formData.participant),n.formData.participant=n.formData.participant.replace(/"/g,"'"),a.next=17,n.$store.dispatch("$_conversation/createConversation",n.formData);case 17:if(s=a.sent,!s){a.next=27;break}return i=j.a.filter(n.listUser,(function(e){return e.id===t})),localStorage.setItem("userInfoOfConversation",JSON.stringify(i)),localStorage.setItem("conversationId",s.id),window.location.reload(),a.next=25,n.$store.dispatch("$_conversation/setUserInfoConversation",i);case 25:return a.next=27,n.$store.dispatch("$_conversation/getConversationDetail",s.id);case 27:n.formData.participant=[];case 28:case"end":return a.stop()}}),a)})))()}},mounted:function(){window.addEventListener("scroll",this.handleScroll)},destroyed:function(){window.removeEventListener("scroll",this.handleScroll)},props:["listConversation","listUser"]},et=tt,at=a("2877"),nt=Object(at["a"])(et,Q,W,!1,null,null,null),rt=nt.exports,st=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{class:0==t.rightInfo?"group-chatBox":"group-chatBox active"},[a("div",{staticClass:"header"},[a("div",[t._v(t._s(t.userInfoOfConversation&&t.userInfoOfConversation.fullName?t.userInfoOfConversation.fullName:""))]),a("div",{staticClass:"collapse-option"},[a("a",{on:{click:t.collapse}},[a("font-awesome-icon",{class:{show:0==t.rightInfo},attrs:{icon:["fas","arrow-circle-right"]}}),a("font-awesome-icon",{class:{show:1==t.rightInfo},attrs:{icon:["fas","arrow-circle-left"]}})],1)])]),a("div",{ref:"containerChat",staticClass:"content",on:{click:t.readMessage}},t._l(t.userChat,(function(e,n){return a("div",{key:n,staticClass:"wrapper"},[e.ownMessage?a("div",{staticClass:"group-chat own-chat"},["sticker"!==e.type?a("div",{staticClass:"chat"},[e.image&&"image"==e.type?a("img",{staticClass:"img-fluid",attrs:{src:e.image}}):t._e(),a("div",[t._v(t._s(e.content))])]):a("div",{staticClass:"sticker"},[e.image&&"sticker"==e.type?a("img",{staticClass:"img-fluid",attrs:{src:e.image}}):t._e()]),a("div",{staticClass:"time ml-3"},[t._v(t._s(e.isToday&&e.createdAt?e.createdAt.slice(10,16):e.createdAt.slice(0,5)+" -"+e.createdAt.slice(10,16)))])]):a("div",{staticClass:"group-chat friend-chat"},[a("div",{staticClass:"mr-3"},[a("div",{staticClass:"avatar",style:{backgroundImage:"url("+(e.userInfo&&e.userInfo.avatar?e.userInfo.avatar:t.NoAvatar)+")"}}),a("div",{staticClass:"time"},[t._v(t._s(e.isToday&&e.createdAt?e.createdAt.slice(10,16):e.createdAt.slice(0,5)+" -"+e.createdAt.slice(10,16)))])]),"sticker"!==e.type?a("div",{staticClass:"chat"},[e.image&&"image"==e.type?a("img",{staticClass:"img-fluid",attrs:{src:e.image}}):t._e(),a("div",[t._v(t._s(e.content))])]):a("div",{staticClass:"sticker"},[e.image&&"sticker"==e.type?a("img",{staticClass:"img-fluid",attrs:{src:e.image}}):t._e()])])])})),0),a("div",{staticClass:"footer"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.formData.content,expression:"formData.content"},{name:"validate",rawName:"v-validate.immediate",value:"required",expression:"'required'",modifiers:{immediate:!0}}],attrs:{placeholder:"Nhập tin nhắn văn bản",rows:"2",name:"contentChat"},domProps:{value:t.formData.content},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.sendMail(e))},input:function(e){e.target.composing||t.$set(t.formData,"content",e.target.value)}}}),a("div",{staticClass:"position-relative"},[a("div",{staticClass:"dropdown-menu uploadChat",class:{show:t.modalImageChat}},[a("font-awesome-icon",{attrs:{icon:["fas","times"]},on:{click:t.removeImage}}),a("div",{staticClass:"dropdown-item"},[a("div",{staticClass:"image-chat shake",style:{backgroundImage:"url("+t.path+")"}})])],1)]),a("div",{staticClass:"position-relative"},[a("div",{staticClass:"dropdown-menu sticker",class:{show:t.modalSticker}},[a("font-awesome-icon",{attrs:{icon:["fas","chevron-down"]},on:{click:t.closeModalStickerChat}}),a("div",{staticClass:"dropdown-item"},[a("el-tabs",{staticClass:"w-100"},t._l(t.stickerList,(function(e,n){return a("el-tab-pane",{key:n},[a("span",{attrs:{slot:"label"},slot:"label"},[a("div",{staticClass:"d-flex justify-content-between align-items-center"},[a("div",{staticClass:"mr-2"},[t._v(t._s(e.name))]),a("img",{staticClass:"img-fluid tab-image",attrs:{src:e.image}})])]),a("div",{staticClass:"row"},t._l(e.sticker,(function(e,n){return a("div",{key:n,staticClass:"col-md-3"},[e.image?a("div",{staticClass:"group-stickers",style:{backgroundImage:"url("+e.image+")"},on:{click:function(a){return t.sendSticker(e.image)}}}):t._e()])})),0)])})),1)],1)],1)]),a("a",{staticClass:"btn btn-chat stiker",on:{click:t.handleModalSticker}},[a("font-awesome-icon",{attrs:{icon:["fas","smile-wink"]}})],1),a("label",{staticClass:"btn btn-chat image",attrs:{for:"uploadImageChat"}},[a("font-awesome-icon",{attrs:{icon:["fas","image"]}}),a("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"uploadImageChat"},on:{change:t.handleFileUpload}})],1),a("button",{staticClass:"btn btn-chat mail",attrs:{disabled:t.errors.items.length>0},on:{click:t.sendMail}},[a("font-awesome-icon",{attrs:{icon:["fas","paper-plane"]}})],1)])]),a("div",{class:0==t.rightInfo?"group-infoBox":"group-infoBox active"},[a("div",[a("div",{staticClass:"avatar",style:{backgroundImage:"url("+(t.userInfoOfConversation&&t.userInfoOfConversation.avatar?t.userInfoOfConversation.avatar:t.NoAvatar)+")"}}),a("div",{staticClass:"email"},[t._v(t._s(t.userInfoOfConversation&&t.userInfoOfConversation.fullName?t.userInfoOfConversation.fullName:""))]),a("div",{staticClass:"number"},[t._v(t._s(t.userInfoOfConversation&&t.userInfoOfConversation.phoneNumber?t.userInfoOfConversation.phoneNumber:""))])])])])},it=[],ot={components:{},data:function(){return{NoAvatar:Z.a,rightInfo:!0,formData:{content:"",type:"text",isDelete:!1,conversationId:"",image:null},file:null,path:null,modalSticker:!1,modalImageChat:!1,modalStickerChat:!1}},computed:Object(u["a"])(Object(u["a"])({},Object(l["c"])({conversationId:function(t){return t.$_conversation.conversationId},userInfoOfConversation:function(t){return t.$_conversation.userInfoConversation}})),Object(l["b"])({stickerList:"$_conversation/getStickerList",dataConversation:"$_conversation/getListConversation"})),methods:{readMessage:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t,n=a.dataConversation.find((function(t){return t.id===a.conversationId})),n.latestMessenger===localStorage.getItem("userId")||!1!==n.isRead){e.next=7;break}return e.next=5,a.$store.dispatch("$_conversation/readNewMessage",n.id);case 5:return e.next=7,a.$store.dispatch("$_conversation/getListConversation");case 7:case"end":return e.stop()}}),e)})))()},collapse:function(){var t=this;t.rightInfo=!t.rightInfo},scrollTop:function(){var t=this,e=t.$refs.containerChat;e.scrollTop=e.scrollHeight},handleModalSticker:function(){var t=this;t.modalSticker=!0,t.modalImageChat=!1,t.removeImage()},closeModalStickerChat:function(){var t=this;t.modalSticker=!1},sendMail:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t,e.next=3,a.$validator.validateAll().then(function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e){t.next=19;break}return t.prev=1,a.formData.conversationId=a.conversationId,t.next=5,a.$store.dispatch("$_conversation/sendMessage",a.formData);case 5:return t.next=7,a.$store.dispatch("$_loginPage/sendSocket",{userInput:a.userInfoOfConversation.id,messageInput:a.formData.content,functionInput:"$_conversation/getConversationDetail",paramsInput:a.conversationId,typeInput:"sendTextMessage"});case 7:return t.next=9,a.$store.dispatch("$_conversation/getConversationDetail",a.conversationId);case 9:return t.next=11,a.$store.dispatch("$_conversation/getListConversation");case 11:a.formData.content="","image"===a.formData.type&&(a.formData.type="text",a.modalImageChat=!1),a.formData.image=null,t.next=19;break;case 16:t.prev=16,t.t0=t["catch"](1),console.log(t.t0);case 19:case"end":return t.stop()}}),t,null,[[1,16]])})));return function(e){return t.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})))()},sendSticker:function(t){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e,a.prev=1,n.formData.conversationId=n.conversationId,n.formData.image=t,n.formData.type="sticker",a.next=7,n.$store.dispatch("$_conversation/sendMessage",n.formData);case 7:return a.next=9,n.$store.dispatch("$_loginPage/sendSocket",{userInput:n.userInfoOfConversation.id,messageInput:n.formData.content,functionInput:"$_conversation/getConversationDetail",paramsInput:n.conversationId,typeInput:"sendTextMessage"});case 9:return a.next=11,n.$store.dispatch("$_conversation/getConversationDetail",n.conversationId);case 11:return a.next=13,n.$store.dispatch("$_conversation/getListConversation");case 13:n.formData.type="text",n.formData.image=null,n.modalStickerChat=!1,a.next=21;break;case 18:a.prev=18,a.t0=a["catch"](1),console.log(a.t0);case 21:case"end":return a.stop()}}),a,null,[[1,18]])})))()},handleFileUpload:function(t){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=e,n.file=t.target.files[0],!n.file){a.next=9;break}return a.next=5,e.$store.dispatch("$_conversation/uploadImage",n.file);case 5:r=a.sent,r&&r.path&&(n.path=r.path,n.formData.type="image",n.formData.image=n.path,n.modalImageChat=!0,n.modalSticker=!1),a.next=10;break;case 9:e.$notify.error({title:"Thất bại",message:"Ảnh k đúng định dạng"});case 10:case"end":return a.stop()}}),a)})))()},removeImage:function(){var t=this;t.file="",t.path="",t.formData.type="text",t.formData.image=null,t.modalImageChat=!1}},updated:function(){var t=this;t.scrollTop()},mounted:function(){var t=this;t.scrollTop()},props:["userChat"]},ct=ot,ut=Object(at["a"])(ct,st,it,!1,null,null,null),lt=ut.exports,dt={components:{"conversation-list":rt,"chat-box":lt},data:function(){return{commonData:d["a"]}},computed:Object(u["a"])(Object(u["a"])({},Object(l["c"])({searchRequest:function(t){return t.$_conversation.searchRequest}})),Object(l["b"])({conversationDetail:"$_conversation/getConversationDetail",dataConversation:"$_conversation/getListConversation",userList:"$_conversation/getUserList"})),created:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t,n="$_conversation",n in t.$store._modules.root._children||a.$store.registerModule(n,H),e.next=5,a.$store.dispatch("$_conversation/getUserList");case 5:return e.next=7,a.$store.dispatch("$_conversation/getListConversation");case 7:return e.next=9,a.$store.dispatch("$_conversation/getStickerList");case 9:if(!localStorage.getItem("conversationId")||!localStorage.getItem("userInfoOfConversation")){e.next=16;break}return e.next=12,a.$store.dispatch("$_conversation/setUserInfoConversation",JSON.parse(localStorage.getItem("userInfoOfConversation")));case 12:return e.next=14,a.$store.dispatch("$_conversation/getConversationDetail",localStorage.getItem("conversationId"));case 14:e.next=22;break;case 16:if(!a.dataConversation||!a.dataConversation.length){e.next=22;break}return localStorage.setItem("userInfoOfConversation",JSON.stringify(a.dataConversation[0].userInfo)),e.next=20,a.$store.dispatch("$_conversation/setUserInfoConversation",a.dataConversation[0].userInfo);case 20:return e.next=22,a.$store.dispatch("$_conversation/getConversationDetail",a.dataConversation[0].id);case 22:case"end":return e.stop()}}),e)})))()},methods:{}},vt=dt,pt=Object(at["a"])(vt,i,o,!1,null,null,null),ft=pt.exports,mt={name:"conversation",data:function(){return{}},components:{Conversation:ft,"nav-menu":s["a"]},methods:{}},gt=mt,ht=Object(at["a"])(gt,n,r,!1,null,null,null);e["default"]=ht.exports}}]);
//# sourceMappingURL=chunk-74915e42.1fa9b943.js.map